\documentclass{article}
\usepackage{graphicx}
\usepackage{amsmath}
\begin{document}

\title{Notes on a general form for the Quantum optimal control Hamiltonian}

\maketitle

\begin{abstract}
  Notes on the form of Hamiltonian and rules for constructing the general matrix form of H.  Some additional comments on notation.
\end{abstract}

\section{Hamiltonian}

A fairly general form of the system Hamiltonian we are interested in looks like this:
\[
H_0 = \sum_i \omega_i a_i^\dagger a_i -\chi_{ii} a_i^\dagger a_i^\dagger a_i a_i -  \sum_{ i\ne j} \chi_{ij}  a_i^\dagger a_i a_j^\dagger  a_j 
\]

where $a_i$ are ``annihilation operators'' that are operating on a subspace of the full Hilbert space (In a way I'll expand on below)
$a | n \rangle = \sqrt{n} |n-1\rangle$,
\begin{equation}
  a = \begin{bmatrix}
    0 & 1 & 0 & 0 & \dotsm & 0 & 0\\
    0 & 0 & \sqrt{2} & 0 & \dotsm & 0 & 0\\
    0 & 0 & 0 & \sqrt{3} & \dotsm & 0 & 0\\
    \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 & 0 & 0 & \dotsm & 0 & \sqrt{n_a-1} \\
    0 & 0 & 0 & 0 & \dotsm & 0 & 0
    \end{bmatrix}.
\end{equation}
$a$ is a matrix of size $n_a \times n_a$. $|n\rangle$ is a column vector where only the $n$th entry is nonzero
\[
\begin{pmatrix}
  0 \\  0 \\ \vdots  \\ 1  \\ \vdots  \\ 0
\end{pmatrix}
\]
The lowering operator $a_i$ is constructed using Kronecker products,
  

More detail on this flaky notation
\[
\langle A | B \rangle \doteq A_1^* B_1 + A_2^* B_2 + \cdots + A_N^* B_N =
\begin{pmatrix} A_1^* & A_2^* & \cdots & A_N^* \end{pmatrix}
\begin{pmatrix} B_1 \\ B_2 \\ \vdots \\ B_N \end{pmatrix}
\]
and
\[
|\phi \rangle \, \langle \psi | \doteq 
\begin{pmatrix} \phi_1 \\ \phi_2 \\ \vdots \\ \phi_N \end{pmatrix}
\begin{pmatrix} \psi_1^* & \psi_2^* & \cdots & \psi_N^* \end{pmatrix}
= \begin{pmatrix}
\phi_1 \psi_1^* & \phi_1 \psi_2^* & \cdots & \phi_1 \psi_N^* \\
\phi_2 \psi_1^* & \phi_2 \psi_2^* & \cdots & \phi_2 \psi_N^* \\
\vdots & \vdots & \ddots & \vdots \\
\phi_N \psi_1^* & \phi_N \psi_2^* & \cdots & \phi_N \psi_N^* \end{pmatrix}
\]

The full Hamiltonian is built up from tensor products of $a$ and $a^\dagger$ operators acting on tensored subspaces.  For example, in the case of qubits, each a acts on a two level subsystem. 
\begin{equation*}a = \left(\begin{array}{*{11}c}0.0 & 1.0\\0.0 & 0.0\\\end{array}\right)\end{equation*}
the full Hamiltonian matrix $H$ for a two qubit system would then be made up of products of operators
$a_0 = a \otimes I_2$ and $a_1 = I_2 \otimes a$ that look like
\begin{equation*}a_0 = a \otimes I_2 = \left(\begin{array}{*{11}c}0.0 & 0.0 & 1.0 & 0.0\\0.0 & 0.0 & 0.0 & 1.0\\0.0 & 0.0 & 0.0 & 0.0\\0.0 & 0.0 & 0.0 & 0.0\\\end{array}\right)\end{equation*}

\begin{equation*}a_1 = I_2 \otimes a = \left(\begin{array}{*{11}c}0.0 & 1.0 & 0.0 & 0.0\\0.0 & 0.0 & 0.0 & 0.0\\0.0 & 0.0 & 0.0 & 1.0\\0.0 & 0.0 & 0.0 & 0.0\\\end{array}\right)\end{equation*}

Here, $I_2$ is the 2x2 identity.

So the full Hamiltonian for a two qubit system would look like 

\[
\begin{array}{ll}
H = & \omega_0 (a \otimes I_2)^{\dagger} (a \otimes I_2) + \omega_1 (I_2 \otimes a)^{\dagger} (I_2 \otimes a)  +\\
& \chi_{00} (a \otimes I_2)^{\dagger} (a \otimes I_2)^{\dagger} (a \otimes I_2) (a \otimes I_2) +\\
& \chi_{11}  (I_2 \otimes a)^{\dagger} (I_2 \otimes a)^{\dagger} (I_2 \otimes a) (I_2 \otimes a) +\\
& \chi_{01}  (a \otimes I_2)^{\dagger} (a \otimes I_2) (I_2 \otimes a)^{\dagger} (I_2 \otimes a) 
\end{array}\
\]

\section{Control terms}
\begin{equation}
H_c = \sum_k \mathcal{F}(t,\underline{\alpha}_k) (a_k + a_k^\dagger) + \sum_k i\mathcal{G}(t,\underline{\alpha}_k) (a_k^\dagger-a_k) 
\end{equation}


\section{example problem}
\subsection{state to state transfer}
The objective is to solve for the control signals that will take the system from some predefined initial state $\rho_0$ to a target final state $\rho_1$

I this example we'll look at a problem suggested by Eric Holland that is fairly simple but physically relevant.  The idea is that the system starts in a thermal state rather than the ideal ground state initial condition and our goal is to find a set of drives that quickly takes the system from this thermal state to the ground state.   Here is 
\begin{equation*}\rho_0 = \left(\begin{array}{*{11}c}0.909 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0\\0.0 & 0.083 & 0.0 & 0.0 & 0.0 & 0.0\\0.0 & 0.0 & 0.008 & 0.0 & 0.0 & 0.0\\0.0 & 0.0 & 0.0 & 6.830\times10^{-04} & 0.0 & 0.0\\0.0 & 0.0 & 0.0 & 0.0 & 6.209\times10^{-05} & 0.0\\0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 5.645\times10^{-06}\\\end{array}\right)\end{equation*}

\end{document}
