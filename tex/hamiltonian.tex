\documentclass[11pt]{article}
\usepackage{amsfonts,amsmath,amssymb,amsthm,graphicx}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage[caption=false]{subfig} 
\usepackage{color}
\usepackage{ifthen}

\setlength{\topmargin}{0 mm}
\setlength{\oddsidemargin}{5 mm}
\setlength{\evensidemargin}{5 mm}
\setlength{\textwidth}{150 mm}
\setlength{\textheight}{210 mm}

\include{macros}

\begin{document}

%% \title{Notes on Schroedinger's equation}

%% \author{N. Anders Petersson\thanks{Center for Applied
%%     Scientific Computing, Lawrence Livermore National Laboratory, L-561, PO Box 808, Livermore CA
%%     94551. }}

%% \date{\today}

%% \maketitle
\section{Hamiltonian structure}
Consider the scaled Schr\"odinger equation
\begin{equation}\label{eq_shrodinger}
\dot{\psi} = -i H(t) \psi,\quad \psi(0) = \psi_0,\quad H(t) = H_s + f(t)a + \bar{f}(t)a^\dag.
\end{equation}
Here, $\psi \in\mathbb{C}^N$ and $H_s = H_s^\dag$ is the system Hamiltonian matrix, which we assume to
be  Hermitian, real-valued, and independent of time. The lowering and raising matrices are denoted
$a$ and $a^\dag$, respectively. These matrices satisfy
\begin{equation}\label{eq_matrices}
%
a = \begin{bmatrix}
0 & 1 & & & &\\
 & 0 & \sqrt{2} & & &\\
&  & 0 & \sqrt{3} & &\\
& &  & 0 & \sqrt{4} & \\
& &  &  & \ddots & \ddots\\
\end{bmatrix},\quad
%
a^\dag = \begin{bmatrix}
0 &  & & &\\
1 & 0 & & &\\
&  \sqrt{2} & 0 &  &\\
& &  \sqrt{3} & 0 & \\
& &  & \ddots & \ddots
\end{bmatrix}
\end{equation}
The time-dependent control terms in \eqref{eq_shrodinger} can be written
\[
f(t)a + \bar{f}(t)a^\dag =
% (f_r(t) + i f_i(t)) a + (f_r(t) - i f_i(t)) a^\dag
f_r(t) (a + a^\dag) + i f_i(t) ( a- a^\dag),\quad f_r = \re f,\quad f_i=\im f,
\]
where $i=\sqrt{-1}$ is the imaginary unit. We conclude that the control terms are Hermitian and
$H(t) = H^\dag(t)$.

To utilize efficient numerical ODE solvers it is desirable to derive a real-valued equivalent of
\eqref{eq_shrodinger}. Let the functions $u(t)$ and $v(t) \in \mathbb{R} \to \mathbb{R}^N$ be
defined by
\[
\psi(t) = u(t) - iv(t)
\]
and decompose the total Hamiltonian matrix into $H(t) = K(t) + i S(t)$, where the real-valued
matrices $K$ and $S$ hold the symmeric and skew-symmetric parts of $H$: $K^\dag = K$ and $S^\dag =
-S$. We have,
\begin{align*}
H\psi &= (K+iS)(u - iv) = (Ku + Sv) + i(Su - Kv),\\
-iH\psi &= -i(Ku + Sv) + (Su - Kv).
\end{align*}
Therefore, a real-valued equivalent of the system \eqref{eq_shrodinger} is
\begin{equation}\label{eq_real-shrodinger}
  \begin{bmatrix} \dot{u}\\ \dot{v} \end{bmatrix} =
%
  \begin{bmatrix}
    S(t) & -K(t) \\ K(t) & S(t)
  \end{bmatrix}     
  %
  \begin{bmatrix} u\\ v \end{bmatrix} .
\end{equation}

We define the time-dependent Hamiltonian function to be
\begin{equation}\label{eq_hamiltonian}
\kappa(u,v,t) = u^T S(t) v + \frac{1}{2} u^T K(t) u + \frac{1}{2} v^T K(t) v.
\end{equation}
We have
\[
\frac{\p\kappa}{\p u_q} =
%
\frac{\p}{\p u_q} \sum_{j,k} \left( u_j S_{j,k} v_k + 0.5 u_j K_{j,k} u_k \right) =
%
\sum_{k} \left( S_{q,k} v_k + 0.5 K_{q,k} u_k \right) + 0.5 \sum_{j} u_j K_{j,q}.
\]
Because $K^T = K$,
\[
\nabla_u \kappa = S v + K u.
\]
In a similar way,
\[
\nabla_v \kappa = S^T u + K v = -S u + Kv.
\]
Therefore, \eqref{eq_real-shrodinger} has the Hamiltonian structure
\begin{equation}\label{eq_hamiltonian-form}
  \begin{bmatrix}
    \dot{u} \\   \dot{v}
  \end{bmatrix} =
  \begin{bmatrix}
    -\nabla_v \kappa(u,v,t)\\
    \nabla_u \kappa(u,v,t)
  \end{bmatrix} =
%
  \begin{bmatrix}
    Su - Kv \\
    Ku + Sv
  \end{bmatrix}
\end{equation}
Because $v^TS^Tu = u^TSv$, the Hamiltonian function \eqref{eq_hamiltonian} can be written
\begin{equation}\label{eq_hamiltonian-time}
\kappa(u,v,t) = \frac{1}{2} \begin{bmatrix} u \\ v \end{bmatrix}^T
%
\begin{bmatrix}
  K(t) & S(t) \\ S^T(t) & K(t)
\end{bmatrix}
\begin{bmatrix} u \\ v \end{bmatrix}.
\end{equation}
We conclude that the Hamiltonian function is non-separable due to the skew-symmetric term
$S(t) =f_i(t) ( a- a^\dag)$ in the original Hamiltonian matrix.

\subsection{Autonomous Hamiltonian form}
A standard approach for transforming a non-autonomous Hamiltonian system into autonomous form is as
follows. First introduce the scalar dependent variable $\tau(t)=t$ which satisfies the trivial equation
\begin{equation}
  \dot{\tau} = 1 ,\quad \tau(0)=0.
\end{equation}
Hence, $\kappa(u,v,t) = \kappa(u,v,\tau)$. Then introduce a scalar variable $e(t)$ and let it satisfy
\begin{equation}\label{eq_e-variable}
  \dot{e} = -\kappa_t(u,v,t),\quad e(0) = -\kappa(u_0, v_0, 0).
\end{equation}
where $u_0 = u(0)$ and $v_0 = v(0)$ are the initial data for \eqref{eq_hamiltonian-form}. Next,
define the generalized momentum and position variables
\[
p = \begin{bmatrix} u\\ e
\end{bmatrix},\quad
q = \begin{bmatrix} v\\ \tau
\end{bmatrix},
\]
and define the extended Hamiltonian function by
\[
\tilde{\kappa}(p,q) = \kappa(u,v,\tau) + e.
\]
We note that
\[
\nabla_{q} \tilde{\kappa} =
\begin{bmatrix}
  \nabla_v \kappa\\
  \kappa_\tau
\end{bmatrix},\quad
%
\nabla_{p} \tilde{\kappa} =
\begin{bmatrix}
  \nabla_u \kappa\\
  1
\end{bmatrix}.
\]
From \eqref{eq_hamiltonian-form}-\eqref{eq_e-variable}, the generalized variables satisfy the differential equation
\begin{equation}\label{eq_auto-hamiltonian}
\begin{bmatrix}
  \dot{p} \\
  \dot{q}
\end{bmatrix} =
%
\begin{bmatrix}
  \dot{u} \\
  \dot{e} \\
  \dot{v} \\
  \dot{\tau}
\end{bmatrix} =
%
\begin{bmatrix}
  -\nabla_v \kappa(u,v,\tau)\\
  -\kappa_\tau(u,v,\tau)\\
  \nabla_u \kappa(u,v,\tau)\\
  1
\end{bmatrix} =
%
\begin{bmatrix}
  -\nabla_q \tilde{\kappa}(p,q)\\
  \nabla_p \kappa(p,q)
\end{bmatrix},
\end{equation}
which is an autonomous Hamiltonian system. By setting $t=\tau$ in \eqref{eq_hamiltonian-time} and
differentiating,
\begin{equation}\label{eq_hamiltonian-time-der}
\kappa_\tau(u,v,\tau) = \frac{1}{2}
\left(
  u^T K'(\tau)u + u^TS'(\tau)v +  v^T S'^T(\tau)u +  v^T K'(\tau)v
\right).
\end{equation}


\subsection{$\rho$-reversibility}
Let $\rho(y)$ be the linear invertible transformation
\[
\rho(y) =
\begin{bmatrix}
  I & 0 \\
  0 & -I
\end{bmatrix}
\begin{bmatrix}
  p\\
  q
\end{bmatrix}=
\begin{bmatrix}
  p\\
  -q
\end{bmatrix},\quad
y = \begin{bmatrix}
  p \\q
\end{bmatrix}.
\]
We write the autonomous Hamiltonian system \eqref{eq_auto-hamiltonian} as
\[
\dot{y} = f(y),\quad
%
f(y) = \begin{bmatrix}
  -\tilde{\kappa}_q \\
  \tilde{\kappa}_p
\end{bmatrix}.
\]
The differential equation $\dot{y}=f(y)$ and the vector field $f(y)$ are
called $\rho$-reversible if
\begin{equation}\label{eq_rho-reverse}
\rho(f(y)) = -f(\rho(y)).
\end{equation}
We have $\rho(y) = (u, e, -v, -\tau)^T$, so the components of the vector field $f(y)$ and $f(\rho(y))$ are
\[
f(y) =
\begin{bmatrix} S(\tau) u - K(\tau)v\\
  -\kappa_\tau(u,v,\tau)\\
  K(\tau) u + S(\tau) v\\
  1
\end{bmatrix},\quad
%
f(\rho(y)) = 
\begin{bmatrix}
  S(-\tau) u + K(-\tau)v\\
  -\kappa_\tau(u,-v,-\tau)\\
  K(-\tau) u - S(-\tau) v\\
  1
\end{bmatrix}.
\]
We also have
\[
\rho(f(y)) =
\begin{bmatrix}
  S(\tau) u - K(\tau)v\\
  -\kappa_\tau(u,v,\tau)\\
  -K(\tau) u - S(\tau) v\\
  -1
\end{bmatrix}.
\]
Thus the conditions for $\rho$-reversibility \eqref{eq_rho-reverse} are satisfied if
\begin{align}
S(\tau) u - K(\tau)v &= -S(-\tau) u - K(-\tau)v,\\
%
-K(\tau) u - S(\tau) v &= -K(-\tau) u + S(-\tau) v,\\
-\kappa_\tau(u,v,\tau) &= \kappa_\tau(u,-v,-\tau).\label{eq_rho-cond3}
\end{align}
The first two conditions are satified if the following symmetry conditions are fulfilled:
\begin{equation}\label{eq_sym-cond}
S(-\tau) = - S(\tau),\quad K(-\tau) = K(\tau).
\end{equation}
From \eqref{eq_hamiltonian-time-der},
\[
\kappa_\tau(u,-v,-\tau) =
\frac{1}{2}
\left(
  u^T K'(-\tau)u - u^TS'(-\tau)v -  v^T S'^T(-\tau)u +  v^T K'(-\tau)v
\right).
\]
The third condition for $\rho$-reversibility, \eqref{eq_rho-cond3}, is thus satisfied if
\[
K'(-\tau) = -K'(\tau),\quad S'(-\tau) = S'(\tau),
\]
which is a consequence of the symmetry conditions \eqref{eq_sym-cond}.

We summarize our result in the following lemma.
\begin{lemma}
  The autonomous Hamiltonian system \eqref{eq_auto-hamiltonian} is $\rho$-reversible if and only if
  the symmetry conditions \eqref{eq_sym-cond} are satisfied.
\end{lemma}


  




\end{document}
