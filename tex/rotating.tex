\documentclass[11pt]{article}
\usepackage{amsfonts,amsmath,amssymb,amsthm,graphicx}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage[caption=false]{subfig} 
\usepackage{color}
\usepackage{ifthen}

\setlength{\topmargin}{0 mm}
\setlength{\oddsidemargin}{5 mm}
\setlength{\evensidemargin}{5 mm}
\setlength{\textwidth}{150 mm}
\setlength{\textheight}{210 mm}

\include{macros}

\begin{document}

\title{The quantum control problem in a rotating frame of reference}

\author{N. Anders Petersson\thanks{Center for Applied
    Scientific Computing, Lawrence Livermore National Laboratory, L-561, PO Box 808, Livermore CA
    94551. }}

\date{\today}

\maketitle

\section{The Schr\"odinger equations}
Consider the Schr\"odinger equation in a laboratory frame of reference,
\begin{equation}\label{eq_schrodinger}
\dot{\psi} = -i H(t) \psi,\quad 0\leq t \leq T,\quad \psi(0) = \psi_0,\quad H(t) = H_s + f(t)(a + a^\dag).
\end{equation}
Here, $\psi(t) \in [0,T]\to {\mathbb C}^N$ is the wave function, $f(t)\in [0,T]\to {\mathbb R}$ is
the control function and $H_s = H_s^\dag$ is the $N\times N$ system Hamiltonian matrix, which we
assume to be real and independent of time. The lowering and raising matrices are denoted $a$ and
$a^\dag$, respectively. These real matrices satisfy
\begin{equation}\label{eq_matrices}
%
a = \begin{bmatrix}
0 & 1 & & & &\\
 & 0 & \sqrt{2} & & &\\
&  & 0 & \sqrt{3} & &\\
& &  & 0 & \sqrt{4} & \\
& &  &  & \ddots & \ddots\\
\end{bmatrix},\quad
%
a^\dag = \begin{bmatrix}
0 &  & & &\\
1 & 0 & & &\\
&  \sqrt{2} & 0 &  &\\
& &  \sqrt{3} & 0 & \\
& &  & \ddots & \ddots
\end{bmatrix}
\end{equation}

The basic model for the system Hamiltonian of a quantum oscillator is
\begin{equation}\label{eq_quantum-osc}
  H_s = \omega_a a^\dag a - \pi \xi_a a^\dag a^\dag a a,\quad a^\dag a =: N = \begin{bmatrix}
  0 & & & & \\
  & 1 & & & \\
  && 2 && \\
  &&& 3 & \\
  &&&& \ddots
\end{bmatrix}.
\end{equation}
Here, $N$ is called the number operator. Clearly, $aa^\dag = a^\dag a + I$, so
\[
a^\dag a^\dag a a = a^\dag ( a a^\dag - I) a = N^2 - N =
\begin{bmatrix}
  0 & & & & \\
  & 0 & & & \\
  && 2 && \\
  &&& 6 & \\
  &&&& \ddots
\end{bmatrix}.
\]
We conclude that $H_s$ is a diagonal matrix. Note that the units of $\omega_a$ is [rad/s].

\subsection{Time-dependent unitary transformations}
Consider the unitary tranformation
\[
\psi(t) = R^{\dag}(t)v(t),\quad R^\dag R = I.
\]
We have
\begin{align*}
\dot{\psi} &= \dot{R}^\dag v + R^\dag \dot{v},\\
H\psi &= H R^\dag v
\end{align*}
Thus, \eqref{eq_schrodinger} gives
\[
\dot{R}^\dag v + R^\dag \dot{v} = -i H R^\dag v,
\]
By using the identity $R \dot{R}^\dag = - \dot{R} R^\dag$ and reorganizing the terms,
\[
\dot{v} = -i R H R^\dag v + \dot{R} R^\dag v = -i\left( RHR^\dag + i \dot{R} R^\dag \right) v.
\]
Thus, the transformed problem becomes
\begin{equation}\label{eq_timedep_trans}
\dot{v} = -i \tilde{H}(t) v,\quad \tilde{H}(t) = R(t)H(t)R(t)^\dag + i \dot{R}(t) R(t)^\dag.
\end{equation}

\subsection{Rotating frame of reference}

In the first term on the right hand side of \eqref{eq_quantum-osc}, the difference between
consequtive diagonal elements is constant. This structure suggests the unitary
transformation
\[
R(t) = \exp(i\omega_a N t),\quad \dot{R}R^\dag = i\omega_a N.
\]
Both $N$ and $N^2$ commute with $R(t)$. From \eqref{eq_timedep_trans}, the first term in the system
Hamiltonian \eqref{eq_quantum-osc} cancels and the transformed Hamiltonian becomes
\begin{equation}\label{eq_rot_hamiltonian}
  \widetilde{H}(t) = -\pi\xi_a \left(N^2 - N\right) +
%
  f(t) \left( R a R^\dag + R a^\dag R^\dag \right).
\end{equation}
We have
\begin{multline*}
  R a R^\dag =\\
  %
\begin{bmatrix}
  1 & & & \\
  & e^{i\omega_a t} & & \\
  & &  e^{2i\omega_a t} & \\
  & & & \ddots
\end{bmatrix}
\begin{bmatrix}
0 & 1 & & &\\
 & 0 & \sqrt{2} & &\\
&  & 0 & \sqrt{3} &\\
& &  & \ddots & \ddots
\end{bmatrix}
\begin{bmatrix}
  1 & & & \\
  & e^{-i\omega_a t} & & \\
  & &  e^{-2i\omega_a t} & \\
  & & & \ddots
\end{bmatrix} = \\
%
\begin{bmatrix}
0 & e^{-i\omega_a t} & & &\\
 & 0 & \sqrt{2} e^{-i\omega_a t}& &\\
&  & 0 & \sqrt{3} e^{-i\omega_a t}  &\\
& &  & \ddots & \ddots
\end{bmatrix} =: e^{-i\omega_a t} a.
%
\end{multline*}
Taking the conjugate transpose gives $R a^\dag R = e^{i\omega_a t} a^\dag$. Thus,
\eqref{eq_rot_hamiltonian} becomes
\begin{equation}\label{eq_trans-hamiltonian}
\widetilde{H}(t) = -\pi\xi_a \left(N^2 - N\right) +
  f(t) \left( e^{-i\omega_a t} a + e^{i\omega_a t} a^\dag \right).
\end{equation}

We would like to absorb the highly oscillatory factors $\exp(\pm i\omega_a t)$ into
$f(t)$. Because the control function $f(t)$ is real-valued, this can only be done in an
approximate fashion. We make the ansatz,
\begin{multline}
  f(t) = 2g_1(t) \cos(\omega_a t) - 2g_2(t) \sin(\omega_a t) = \\
  %
  \left(g_1 + i g_2\right)\exp(i\omega_a t) + \left( g_1 - i g_2 \right)
  \exp(-i\omega_a t),
\end{multline}
where $g_1(t)$ and $g_2(t)$ are real-valued function. Thus,
\begin{align}
f(t)\exp(-i\omega_a t) &= \left(g_1 + ig_2\right) +  \left(g_1 - ig_2\right)
\exp(-2i\omega_a t),\\
%
f(t)\exp(i\omega_a t) &= \left(g_1 + i g_2\right)\exp(2i\omega_a t) +  \left(g_1 - ig_2\right).
\end{align}
The transformed Hamiltonian \eqref{eq_trans-hamiltonian} becomes
\begin{align*}
\widetilde{H}(t) &= -\pi\xi_a \left(N^2 - N\right) \\
&\quad +\left(g_1 + i g_2\right) a +  \left(g_1 - i g_2\right) \exp(-2i\omega_a t) a +
%
\left(g_1 + i g_2\right)\exp(2i\omega_a t) a^\dag +  \left(g_1 - i g_2\right) a^\dag \\
%
&= -\pi\xi_a \left(N^2 - N\right) + g_1\left( a + a^\dag \right) + i g_2 \left( a - a^\dag \right)
\\
&\quad +
\left(g_1 - ig_2\right) \exp(-2i\omega_a t) a  + \left(g_1 + ig_2\right)\exp(2i\omega_a t) a^\dag.
\end{align*}
The rotating frame approximation follows by ignoring the terms that oscillate with twice the
frequency, $\exp(\pm 2i\omega_a t)$, resulting in the system
\begin{align}
\dot{v} &= - \widetilde{H}_r(t) v,\quad v(0) = R(0) \psi_0 = \psi_0,\\
%
\widetilde{H}_r(t) &=  H_d + g_1(t)\left( a + a^\dag \right) + i g_2(t) \left( a - a^\dag
\right),\quad H_d = -\pi\xi_a \left(N^2 - N\right).
\end{align}
Here, $H_d$ is called the drift Hamiltonian. When $\xi_a \ll \omega_a$, the solutions of this system
varies on a significantly longer time scale than \eqref{eq_schrodinger}.

After the control functions $g_1(t)$ and $g_2(t)$ have been determined, the corresponding control
function in the laboratory frame becomes
\begin{equation}\label{eq_control_lab}
f(t) = 2g_1(t) \cos(\omega_a t) - 2g_2(t) \sin(\omega_a t).
\end{equation}

\section{Analytical solutions}

The $2\times 2$ Schr\"odinger system in the rotating frame with constant control functions $g_1=
\Omega_r$ and $g_2=\Omega_i$ satisfies
\begin{equation}\label{eq_2-by-2}
\dot{v} = -i \widetilde{H} v,\quad \widetilde{H} = \Omega_r(a + a^\dag) + i \Omega_i(a-a^\dag) =
%
\begin{bmatrix}
  0 & \Omega \\
  \bar{\Omega} & 0
\end{bmatrix},\quad \Omega = \Omega_r + i\Omega_i.
\end{equation}
The complex matrix $\widetilde{H}$ can be diagonalized by the unitary matrix $X$,
\[
X =
\frac{1}{\sqrt{2}}
\begin{bmatrix}
  1 & -\Omega/|\Omega| \\
  %
  \bar{\Omega}/|\Omega| & 1
\end{bmatrix},\quad
X^\dag \widetilde{H} X = \begin{bmatrix}
  |\Omega| & 0 \\
  0 & |\Omega|
\end{bmatrix}.
\]
By the variable transformation
\[
\widetilde{v} = X^\dag v,
\]
the system \eqref{eq_2-by-2} becomes and is solved by
\[
\dot{\widetilde{v}} = -i
\begin{bmatrix}
  |\Omega| & 0 \\
  0 & |\Omega|
\end{bmatrix} \widetilde{v},\quad
%
\widetilde{v}(t) = \begin{bmatrix}
\alpha \exp(-i |\Omega| t) \\
\beta \exp(i |\Omega| t)
\end{bmatrix},
\]
where $\alpha$ and $\beta$ are constants. Transforming back to the original variables, $v = X
\widetilde{v}(t)$, gives
\[
v(t) = X \widetilde{v} = \frac{1}{\sqrt{2}}
\begin{bmatrix}
  \alpha \exp(-i |\Omega| t) - \frac{\Omega}{|\Omega|} \beta \exp(i |\Omega| t) \\
  \frac{\bar{\Omega}}{|\Omega|} \alpha \exp(-i |\Omega| t) + \beta \exp(i |\Omega| t)
\end{bmatrix}
\]
To form a basis for all initial data, we first consider
\[
v^{I}(0) : =
%
\frac{1}{\sqrt{2}}
\begin{bmatrix}
  \alpha_1 - \frac{\Omega}{|\Omega|} \beta_1 \\
  \frac{\bar{\Omega}}{|\Omega|} \alpha_1 + \beta_1
\end{bmatrix} = \begin{bmatrix} 1 \\ 0 \end{bmatrix},
%
\quad
\begin{bmatrix}
\alpha_1\\ \beta_1
\end{bmatrix}=
\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 \\ -\frac{\bar{\Omega}}{|\Omega|}
\end{bmatrix}.
\]
The second initial data is
\[
v^{II}(0) : =
%
\frac{1}{\sqrt{2}}
\begin{bmatrix}
  \alpha_2 - \frac{\Omega}{|\Omega|} \beta_2 \\
  \frac{\bar{\Omega}}{|\Omega|} \alpha_2 + \beta_2
\end{bmatrix} = \begin{bmatrix} 0 \\ 1 \end{bmatrix},
%
\quad
\begin{bmatrix}
\alpha_2\\ \beta_2
\end{bmatrix}=
\frac{1}{\sqrt{2}}
\begin{bmatrix}
\frac{\Omega}{|\Omega|} \\ 1
\end{bmatrix}.
\]

After some algebra, the two fundamental solutions can be written,
\[
v^{I}(t) =
\begin{bmatrix}
  \cos(|\Omega| t)\\
  -i\frac{\bar{\Omega}}{|\Omega|} \sin(|\Omega t)
\end{bmatrix},\quad
%
v^{II}(t) =
\begin{bmatrix}
  -i\frac{\Omega}{|\Omega|} \sin(|\Omega t)\\
  \cos(|\Omega| t) 
\end{bmatrix}.
\]
Thus, the evolution from the canonical basis is
\[
V(t) =
\begin{bmatrix}
  \cos(|\Omega| t) &  -i\frac{\Omega}{|\Omega|} \sin(|\Omega t)\\
  -i\frac{\bar{\Omega}}{|\Omega|} \sin(|\Omega t) &  \cos(|\Omega| t) 
\end{bmatrix}.
\]
It is instructive to set 
\begin{equation}\label{eq_omega-phase}
\Omega: = \Omega_r + i \Omega_i = |\Omega|(\cos(\theta) + i\sin(\theta)).
%\frac{\Omega}{|\Omega|} = \cos(\theta) + i \sin(\theta),\quad
%\frac{\bar{\Omega}}{|\Omega|} = \cos(\theta) - i \sin(\theta),
\end{equation}
and
\[
V(t) =
\begin{bmatrix}
  \cos(|\Omega| t) &  (\sin(\theta) -i\cos(\theta) ) \sin(|\Omega t)\\
  -(\sin(\theta) + i\cos(\theta)) \sin(|\Omega t) &  \cos(|\Omega| t) 
\end{bmatrix}.
\]

The control function in the laboratory frame follows by inserting $g_1=\Omega_r$ and $g_2=\Omega_i$
in \eqref{eq_control_lab},
\begin{equation}
  f(t) = 2\Omega_r \cos(\omega_a t) - 2\Omega_i \sin(\omega_a t)
  %= 2|\Omega|\left( \cos(\theta)
  %\cos(\omega_a t) - \sin(\theta) \sin(\omega_a t) \right) \\
  %
  = 2|\Omega| \cos(\omega_a t + \theta).
\end{equation}
In this case, the amplitude of the control function equals the angular frequency of $V(t)$. Hence,
the period of the oscillation is
\[
T = \frac{2\pi}{|\Omega|}.
\]
The phase of $V(t)$ is controlled by the phase of the control function, $\theta$.




\end{document}
