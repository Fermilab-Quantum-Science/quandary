\documentclass[11pt]{article}
\usepackage{amsfonts,amsmath,amssymb,amsthm,graphicx}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage[caption=false]{subfig} 
\usepackage{color}
\usepackage{ifthen}

\setlength{\topmargin}{0 mm}
\setlength{\oddsidemargin}{5 mm}
\setlength{\evensidemargin}{5 mm}
\setlength{\textwidth}{150 mm}
\setlength{\textheight}{210 mm}

\include{macros}

\begin{document}

%% \title{Notes on Schroedinger's equation}

%% \author{N. Anders Petersson\thanks{Center for Applied
%%     Scientific Computing, Lawrence Livermore National Laboratory, L-561, PO Box 808, Livermore CA
%%     94551. }}

%% \date{\today}

%% \maketitle
\section{Change of variables}
Consider the scaled Schr\"odinger equation
\begin{equation}\label{eq_shrodinger}
\dot{\psi} = -i H(t) \psi,\quad \psi(0) = \psi_0,\quad H(t) = H_s + f(t)a + \bar{f}(t)a^\dag.
\end{equation}
Here, $H_s = H_s^\dag$ is the system Hamiltonian matrix, which we assume to be Hermitian and
independent of time. The lowering and raising matrices are denoted $a$ and $a^\dag$,
respectively. These matrices satisfy
\begin{equation}\label{eq_matrices}
%
a = \begin{bmatrix}
0 & 1 & & & &\\
 & 0 & \sqrt{2} & & &\\
&  & 0 & \sqrt{3} & &\\
& &  & 0 & \sqrt{4} & \\
& &  &  & \ddots & \ddots\\
\end{bmatrix},\quad
%
a^\dag = \begin{bmatrix}
0 &  & & &\\
1 & 0 & & &\\
&  \sqrt{2} & 0 &  &\\
& &  \sqrt{3} & 0 & \\
& &  & \ddots & \ddots
\end{bmatrix}
\end{equation}
Because $H_s$ is Hermitian, it has real eigenvalues and can always be diagonalized by a unitary
matrix $V$. By the change of variables, $u(t)=V \psi(t)$, Schr\"odinger's equation
\eqref{eq_shrodinger} becomes
\[
\dot{u} = -i VH(t)V^\dag u,\quad VH(t)V^\dag = H_0 + f(t)\tilde{a} + \bar{f}(t)\tilde{a}^\dag,
\]
where $\tilde{a}=V a V^\dag$.

%% \subsection{A simple example}
%% We make the change of variables
%% \[
%% \psi(t) = e^{-i\omega_0 t} u(t).
%% \]
%% We have
%% \begin{align*}
%%   \dot{\psi} &= -i\omega_0 e^{-i\omega_0 t} u + e^{-i\omega_0 t} \dot{u},\\
%%   H \psi &= e^{-i\omega_0 t} H u.
%% \end{align*}
%% Therefore,
%% \[
%% \dot{\psi} = -i\omega_0 e^{-i\omega_0 t} u + e^{-i\omega_0 t} \dot{u} = -ie^{-i\omega_0 t} H u,
%% \]
%% and
%% \[
%% e^{-i\omega_0 t} \dot{u} = i\omega_0 e^{-i\omega_0 t} u  -ie^{-i\omega_0 t} H u.
%% \]
%% The factor $e^{-i\omega_0 t}$ cancels and we get
%% \[
%% \dot{u} = -i\left(H - \omega_0 I\right)u =: -i\left(H_0 - \omega_0 I + f(t)a + \bar{f}(t)a^\dag \right)u.
%% \]
%% Thus, only the diagonal part of the Hamiltonian matrix is modified by the change of variables.

\subsection{Time-dependent unitary transformations}
Consider the unitary tranformation
\[
\psi(t) = U^{\dag}(t)v(t),\quad U^\dag U = I.
\]
We have
\begin{align*}
\dot{\psi} &= \dot{U}^\dag v + U^\dag \dot{v},\\
H\psi &= H U^\dag v
\end{align*}
Thus, \eqref{eq_shrodinger} gives
\[
\dot{U}^\dag v + U^\dag \dot{v} = -i H U^\dag v,
\]
After reorganizing the terms,
\[
\dot{v} = -i U H U^\dag v + \dot{U} U^\dag = -i\left( UHU^\dag + i \dot{U} U^\dag \right) v,
\]
because $U \dot{U}^\dag = - \dot{U} U^\dag$. Thus, the transformed problem becomes
\[
\dot{v} = -i \tilde{H}(t) v,\quad \tilde{H} = UHU^\dag + i \dot{U} U^\dag.
\]

%% \subsection{Rotating frame (one frequency)}

%% Consider the unitary transformation,
%% \[
%% U(t) = \exp(i\omega_k t E_k),\quad E_k = \eb_k \eb_k^T,
%% \]
%% where $\eb_k$ is the $k^{th}$ unit basis vector. For example, if $k=1$,
%% \[
%% i\omega_1 t E_1 = \begin{bmatrix}
%%   0 & & & \\
%%   & i\omega_1 t & & \\
%%   & & 0 & \\
%%   & & & \ddots
%% \end{bmatrix},\quad
%% U(t) = \exp(i\omega_1 t E_1) = \begin{bmatrix}
%%   1 & & & \\
%%   & e^{i\omega_1 t} & & \\
%%   & & 1 & \\
%%   & & & \ddots
%% \end{bmatrix}
%% \]
%% Thus,
%% \[
%% \dot{U}(t) = i\omega_1 \begin{bmatrix}
%%   0 & & & \\
%%   & e^{i\omega_1 t} & & \\
%%   & & 0 & \\
%%   & & & \ddots
%% \end{bmatrix},\quad
%% i\dot{U} U^\dag =  i^2 \omega_1 \begin{bmatrix}
%%   0 & & & \\
%%   & 1 & & \\
%%   & & 0 & \\
%%   & & & \ddots
%% \end{bmatrix}
%% \]
%% Because $H_0$ and $U$ are diagonal, $U^\dag H_0 U = H_0 U^\dag U = H_0$. Thus,
%% \[
%% U^\dag H_0 U + i\dot{U} U^\dag = \begin{bmatrix}
%% \omega_0 & & &\\
%% & 0 &&\\
%% & & \omega_2 &\\
%% & & & \ddots
%% \end{bmatrix},
%% \]
%% and
%% \begin{multline*}
%% U^\dag a U =
%% \begin{bmatrix}
%%   1 & & & \\
%%   & e^{-i\omega_1 t} & & \\
%%   & & 1 & \\
%%   & & & \ddots
%% \end{bmatrix}
%% \begin{bmatrix}
%% 0 & 1 & & &\\
%%  & 0 & \sqrt{2} & &\\
%% &  & 0 & \sqrt{3} &\\
%% & &  & 0 & \ddots
%% \end{bmatrix}
%% \begin{bmatrix}
%%   1 & & & \\
%%   & e^{i\omega_1 t} & & \\
%%   & & 1 & \\
%%   & & & \ddots
%% \end{bmatrix} = \\
%% %
%% \begin{bmatrix}
%% 0 & e^{i\omega_1 t} & & &\\
%%  & 0 & \sqrt{2} e^{-i\omega_1 t} & &\\
%% &  & 0 & \sqrt{3} &\\
%% & &  & 0 & \ddots
%% \end{bmatrix}
%% \end{multline*}

\subsection{Rotating frame (interaction picture)}

We can construct a unitary transformation based
on the time-independent matrix $H_s$ in \eqref{eq_matrices},
\[
U(t) = \exp(i H_s t).
\]
We have $\dot{U}(t) = i H_s \exp(i H_s t)$, which gives
\[
\dot{U}U^\dag =  i H_s \exp(i H_s t) \exp(- i H_s t) = i H_s.
\]
From the definition of the matrix exponential,
\[
\exp(i H_s t) = I + it H_s + \frac{1}{2} (it)^2 H_s^2 + \frac{1}{6} (it)^3 H_s^3 + \ldots.
\]
Thus it is clear that $U=\exp(i H_s t)$ commutes with $H_s$ and $UH_sU^\dag = H_s$. As a result, the
constant (time-independent) part of the transformed Hamiltonian cancels,
\[
\tilde{H}(t) = U H U^\dag + i \dot{U}U^\dag = f(t) UaU^\dag + \bar{f}(t) Ua^\dag U^\dag.
\]

\subsection{Diagonal $H_s$}
When $H_s=H_0$ is real and diagonal,
\[
H_0=\begin{bmatrix}
\omega_0 & & &\\
& \omega_1 &&\\
& & \omega_2 &\\
& & & \ddots
\end{bmatrix},\quad
%
U(t) = \exp(i H_0 t)=
\begin{bmatrix}
e^{i\omega_0t} & & &\\
& e^{i\omega_1 t} &&\\
& & e^{i\omega_2 t} &\\
& & & \ddots
\end{bmatrix}
\]
The lowering operator transforms according to
\begin{multline*}
UaU^\dag =
\begin{bmatrix}
  e^{-i\omega_0t} & & & \\
  & e^{-i\omega_1 t} & & \\
  & &  e^{-i\omega_2 t} & \\
  & & & \ddots
\end{bmatrix}
\begin{bmatrix}
0 & 1 & & &\\
 & 0 & \sqrt{2} & &\\
&  & 0 & \sqrt{3} &\\
& &  & \ddots & \ddots
\end{bmatrix}
\begin{bmatrix}
  e^{i\omega_0t} & & & \\
  & e^{i\omega_1 t} & & \\
  & &  e^{i\omega_2 t} & \\
  & & & \ddots
\end{bmatrix} = \\
%
\begin{bmatrix}
0 & e^{i(\omega_1 - \omega_0)t} & & &\\
 & 0 & \sqrt{2} e^{i(\omega_2 -\omega_1) t}& &\\
&  & 0 & \sqrt{3} e^{i(\omega_3 -\omega_2)t}  &\\
& &  & \ddots & \ddots
\end{bmatrix}
%
\end{multline*}
The transformed equation becomes $\dot{v} = -i\tilde{H}(t)v$, where
\[
\tilde{H}(t) = \begin{bmatrix}
0 & f(t) e^{i(\omega_1 - \omega_0)t} & & &\\
\bar{f}(t) e^{-i(\omega_1 - \omega_0)t} & 0 & f(t) \sqrt{2} e^{i(\omega_2 -\omega_1) t}& &\\
& \bar{f}(t) \sqrt{2} e^{-i(\omega_2 -\omega_1) t} & 0 & f(t) \sqrt{3} e^{i(\omega_3 -\omega_2)t}
&\\
\\
& & \ddots & \ddots & \ddots
\end{bmatrix}.
\]

The structure of the transformed Hamiltonian provides insight into how to induce resonance in the
system. For example, by taking $f(t)=\Omega e^{-i(\omega_1 - \omega_0)t}$, the Hamiltonian matrix
becomes
\[
\tilde{H}(t) = \begin{bmatrix}
0 & \Omega & & &\\
\bar{\Omega} & 0 & f(t) \sqrt{2} e^{i(\omega_2 -\omega_1) t}& &\\
& \bar{f}(t) \sqrt{2} e^{-i(\omega_2 -\omega_1) t} & 0 & f(t) \sqrt{3} e^{i(\omega_3 -\omega_2)t}
&\\
\\
& & \ddots & \ddots & \ddots
\end{bmatrix}.
\]
The dynamics of the system will be dominated by an oscillation between the ground state and the
first excited state, with frequency $\Omega$.




\end{document}
